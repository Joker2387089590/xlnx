/*
 * Author: michaelc
 * Version:  
 * Today is: Sun Sep  5 01:47:35 2021
 */

/dts-v1/;
#include "user/zynq-7000.dtsi"
#include "user/pcw.dtsi"
/ {
	chosen {
		// onsole=ttyPS0,115200 earlyprintk 指定打印输出端口
		// root=/dev/mmcblk0p2 rootwait rw rootfstype=ext4  kernel 的文件系统加载位置
		bootargs = "console=ttyPS0,115200 earlyprintk root=/dev/mmcblk0p2 rootwait rw rootfstype=ext4";
		stdout-path = "serial0:115200n8";
	};
	aliases {
		// 网口位置
		ethernet0 = &gem0;
		// 串口与UART 的映射关系，这个跟FPGA 硬件设计相关
		serial0 = &uart0;
		serial1 = &uart1;
		spi0 = &qspi;
		usb0 = &usb0;
		// mmc0 = &sdhci0;
	};
	memory {
		device_type = "memory";
		// DDR 内存寻址空间大小，7007系列的是512MB(0x20000000) ,7020系列是1GB(0x40000000)
		reg = <0x0 0x40000000>;
	};

	leds {
		// 使用gpio-leds驱动 
		compatible = "gpio-leds";
		// “led-ds23”: 仅名字，按需更改
		led-ps {
			label = "ps-led";
			// gpio0组， 7：MIO 的第7个IO:  
			gpios = <&gpio0 7 0>;
			linux,default-trigger = "heartbeat";
		};
		led-pl{
			label = "pl-led";
			// gpio0组， 54：EMIO 的第1个IO:  
			gpios = <&gpio0 54 0>;
			linux,default-trigger = "heartbeat";
		};
	};
};

&gem0 { 
		// 网卡的MAC 地址
		local-mac-address = [00 0a 35 00 1e 53]; 
};

&sdhci0 {
	u-boot,dm-pre-reloc;
	status = "okay";
};
&uart0 {
	status = "okay";
};
&uart1 {
	status = "okay";
};


&qspi {
    status = "okay";
    is-dual = <0>;
    num-cs = <1>;
        flash@0 {
			// 128Mb qspi 
                compatible = "n25q128a11";
                reg = <0x0>;
                spi-tx-bus-width = <1>;
                spi-rx-bus-width = <4>;
                spi-max-frequency = <50000000>;
                #address-cells = <1>;
                #size-cells = <1>;
				// 4MB
                partition@qspi-u-boot {
                label = "qspi-u-boot";
                reg = <0x0 0x400000>;
                };
                partition@qspi-u-boot-env {
                    label = "qspi-u-boot-env";
                    reg = <0x400000 0x100000>;
                };
                partition@qspi-bitstream {
                    label = "qspi-bitstream";
                    reg = <0x500000 0x500000>;
                };
				partition@qspi-devicetree {
                    label = "qspi-devicetree";
                    reg = <0xA00000 0x100000>;
                };
                partition@qspi-uImage {
                    label = "qspi-uImage";
                    reg = <0xB00000 0x500000>;
                };
        };
};
